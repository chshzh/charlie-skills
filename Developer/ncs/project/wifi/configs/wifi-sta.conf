#
# Wi-Fi Station Mode Configuration
# Use when connecting to an existing Wi-Fi network (router/AP)
#

# Wi-Fi driver
CONFIG_WIFI=y
CONFIG_WIFI_NRF70=y

# Wi-Fi ready library for safe initialization
CONFIG_WIFI_READY_LIB=y

# Networking stack
CONFIG_NETWORKING=y
CONFIG_NET_SOCKETS=y
CONFIG_NET_LOG=y
CONFIG_NET_IPV4=y
CONFIG_NET_UDP=y
CONFIG_NET_TCP=y

# Network buffers
CONFIG_NET_PKT_RX_COUNT=16
CONFIG_NET_PKT_TX_COUNT=16
CONFIG_NET_BUF_RX_COUNT=32
CONFIG_NET_BUF_TX_COUNT=32
CONFIG_NRF70_RX_NUM_BUFS=16

# CRITICAL: Wi-Fi requires minimum 80KB heap
# Symptoms of insufficient memory:
# - Connection failures
# - "Out of memory" errors
# - Unstable operation
CONFIG_HEAP_MEM_POOL_SIZE=80000
CONFIG_HEAP_MEM_POOL_IGNORE_MIN=y
CONFIG_NRF_WIFI_CTRL_HEAP_SIZE=40000
CONFIG_NRF_WIFI_DATA_HEAP_SIZE=100000

# Network interface configuration
CONFIG_NET_IF_UNICAST_IPV4_ADDR_COUNT=2
CONFIG_NET_MAX_CONTEXTS=10
CONFIG_NET_CONTEXT_SYNC_RECV=y

# Ethernet L2
CONFIG_NET_L2_ETHERNET=y

# Zephyr NET Connection Manager
CONFIG_NET_CONNECTION_MANAGER=y
CONFIG_L2_WIFI_CONNECTIVITY=y
CONFIG_L2_WIFI_CONNECTIVITY_AUTO_CONNECT=y
CONFIG_L2_WIFI_CONNECTIVITY_AUTO_DOWN=n

# Wi-Fi credentials storage
CONFIG_WIFI_CREDENTIALS=y
CONFIG_WIFI_CREDENTIALS_CONNECT_STORED=y
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FLASH_MAP=y
CONFIG_NVS=y
CONFIG_SETTINGS=y
CONFIG_SETTINGS_NVS=y

# DHCP client for getting IP from AP
CONFIG_NET_DHCPV4=y

# Network shell (for Wi-Fi credentials)
CONFIG_SHELL=y
CONFIG_NET_SHELL=y

# Disable auto network init (handle manually)
CONFIG_NET_CONFIG_SETTINGS=n

# Stack sizes
CONFIG_NET_TX_STACK_SIZE=4096
CONFIG_NET_RX_STACK_SIZE=4096

# Configure credentials via shell:
# uart:~$ wifi cred add -s "YourSSID" -p "YourPassword" -k 1
# uart:~$ wifi cred auto_connect
